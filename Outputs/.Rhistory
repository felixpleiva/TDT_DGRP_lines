# -------------------------------------------------------------------------------------
# Script to plot correlations between traits measured in twenty DGRP lines
# Data generated by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2021, July 21). Draft version
# of paper data and code of manuscript: Intraspecific variation on heat
# tolerance in a model ectotherm: effects of body mass, cell size, oxygen and
# sex (1.0). Zenodo. https://doi.org/10.5281/zenodo.5120029
# -------------------------------------------------------------------------------------
# Clean working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# -------------------------------------------------------------------------------------
setwd("C:/Users/Invunche/Dropbox/GitHub/TDT_DGRP_lines/Outputs")
# check directory
getwd()
# -------------------------------------------------------------------------------------
#Libraries
library(lme4)
library(ggplot2)
library(cowplot)
# ------------
# -------------------------------------------------------------------------------------
# load data
traits<-read.csv("2.1.1. Phenotypic traits data of DGRP lines.csv")
head(traits)
str(traits)
traits$stock<-as.factor(traits$stock)
traits$sex<-as.factor(traits$sex)
#reorder the columns
traits<-traits[,c(1:6,8,9,7,11,10)]
names(traits)
traits.mean<-aggregate(cbind(fw,iod,ws,cell.number,cell.area)~stock+genotype+sex,traits,mean)
# -------------------------------------------------------------------------------------
# FIGURE S5
# -------------------------------------------------------------------------------------
male<-subset(traits.mean,sex!="female")
male$stock <- reorder(male$stock, male$cell.area)
levels(male$stock)#to check if order is 0K
col.male1=col=c("#CC3333","#666699","#666666","#339999","#993366","#339966","#996633","#FF9900","#669966","#FFFF33",
"#996699","#CC9933","#CC6666","#FF6633","#FFCC33","#c00000","#FF99CC","#CC9999","#CC6699","#999999")
{
pdf("8.2.4. Figure S5 Pairwise correlation between between traits (mean values for males).pdf",width = 7,height = 7)
#png("8.2.4. Figure S5 Pairwise correlation between between traits (mean values for males).png",width = 7,height = 7,units = "in",res = 300)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = col.male1[male$stock])
}
# Create the plots
pairs(male[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
}
{
#pdf("8.2.4. Figure S5 Pairwise correlation between between traits (mean values for males).pdf",width = 7,height = 7)
png("8.2.4. Figure S5 Pairwise correlation between between traits (mean values for males).png",width = 7,height = 7,units = "in",res = 300)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = col.male1[male$stock])
}
# Create the plots
pairs(male[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
}
