# ------------------------------------------------------------------------------
# Script to generate Figure 2, Figure 3 and Tables S1-S6
# Data generated by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by Félix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Santos M, Rezende E, & Verberk WCEP. (2021, July 21). Draft version
# of paper data and code of manuscript: Intraspecific variation on heat
# tolerance in a model ectotherm: effects of body mass, cell size, oxygen and
# sex (2.0). Zenodo. https://doi.org/10.5281/zenodo.5244364
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
#-------------------------------------------------------------------------------
#get working directory
setwd("C:/Users/Invunche/Dropbox/GitHub/TDT_DGRP_lines/Outputs")
getwd()# check directory
#-------------------------------------------------------------------------------
#Libraries
library(multcomp)
library(car)
library(lme4)
library(dplyr)
library(MuMIn)
#-------------------------------------------------------------------------------
#load data
datos<-read.csv("2.1.1. Phenotypic traits data of DGRP lines.csv")
#-------------------------------------------------------------------------------
#Checking the structure of data frame
str(datos)
datos$stock<-as.factor(datos$stock)
datos$plate<-as.factor(datos$plate)
datos$age<-as.numeric(datos$age)
datos$well<-as.factor(datos$well)
datos$sex<-as.factor(datos$sex)
datos$genotype<-as.factor(datos$genotype)
#-------------------------------------------------------------------------------
#rename some columns
names(datos)
datos <- rename(datos, wing.area = ws)
datos <- rename(datos, fresh.mass = fw)
#-------------------------------------------------------------------------------
# Subset to plot
female<-subset(datos,datos$sex=="female")#females
male<-subset(datos,datos$sex=="male")#males
#-------------------------------------------------------------------------------
# Ascending order of cell area (by MEDIAN) for better visualization
female$stock <- reorder(female$stock, female$cell.area.z,FUN=median)
levels(female$stock)#to check if order is 0K
# "25182" "25198" "25180" "29652" "28191" "28248" "25190" "25192" "28247" "28197"
# "28141" "28135" "28258" "28153" "28198" "28173" "25203" "25201" "28180" "28196"
# reorder stocks in males as in females to improve the visualization
male$stock <- factor(male$stock, levels =
c("25182", "25198","25180","29652","28191",
"28248","25190","25192","28247","28197",
"28141","28135","28258","28153","28198",
"28173","25203","25201","28180","28196"))
#Setting same colour for each DGRP line
col.female1=col=c("#CC3333","#993366","#666699","#339999","#339966","#669966","#666666","#996699","#CC6666","#FF6633",
"#FF9900","#FFCC33","#FFFF33","#CC9933","#996633","#c00000","#CC6699","#FF99CC","#CC9999","#999999")
col.male1=col=c("#CC3333","#993366","#666699","#339999","#339966","#669966","#666666","#996699","#CC6666","#FF6633",
"#FF9900","#FFCC33","#FFFF33","#CC9933","#996633","#c00000","#CC6699","#FF99CC","#CC9999","#999999")
summary(datos$fresh.mass)
1.65/0.33
