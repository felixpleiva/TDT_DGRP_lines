scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*cell.area.rel*scale(test.oxygen)
+scale(test.temp)*fw.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit,method = "ML")
m3.2<-gls(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*cell.area.rel*scale(test.oxygen)
+scale(test.temp)*cell.number.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit,method = "ML")
m3.3<-gls(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*cell.area.rel*scale(test.oxygen)
+scale(test.temp)*iod.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit,method = "ML")
fit.list.step6 <- list(m2.1,m3.1,m3.2,m3.3)
fit.names.step6 <-c("ST * O2 + ST * sex * O2 + ST * O2 * Cell area",
"ST * O2 + ST * sex * O2 + ST * O2 * Cell area + ST * O2 * FM",
"ST * O2 + ST * sex * O2 + ST * O2 * Cell area + ST * O2 * CN",
"ST * O2 + ST * sex * O2 + ST * O2 * Cell area + ST * O2 * IOD")
#compare by using AICc
fit.step6<-aictab(fit.list.step6,fit.names.step6, second.ord = T,sort = TRUE, digits = 3, LL=TRUE)
fit.step6
#                                                               K    AICc Delta_AICc AICcWt Cum.Wt    LL
# ST * O2 + ST * sex * O2 + ST * O2 * Cell area                 13 -107.07       0.00   0.86   0.86 68.87
# ST * O2 + ST * sex * O2 + ST * O2 * Cell area + ST * O2 * IOD 17 -103.09       3.98   0.12   0.98 72.68
# ST * O2 + ST * sex * O2 + ST * O2 * Cell area + ST * O2 * FM  17  -98.28       8.79   0.01   0.99 70.27
# ST * O2 + ST * sex * O2 + ST * O2 * Cell area + ST * O2 * CN  17  -97.32       9.75   0.01   1.00 69.79
# model including sex and relative fresh mass works better, though adding
# test temp and interocular distance or test temp and cell area is also important
# (DeltaAICc lower than 2).
# ------------------------------------------------------------------------------
# Lets drop the best model
# (1) ST * O2 + ST * sex * O2 + ST * O2 * Cell area
drop1(m2.1,test = "Chisq")
summary(m2.1)
anova(m2.1)
# Cell size interacts with stress temp and also with oxygen. The most significant
# effect os due to test.temp and test.temp and oxygen interaction. Similarly as in
# the experiment under normoxia , there is a significant effects of the interaction
# between sex and test temp.
# ------------------------------------------------------------------------------
# Step 7: Lets now exclude the non significant variables
# ------------------------------------------------------------------------------
#exclude the three-ways interaction
m4.1<-gls(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex
+scale(test.temp)*cell.area.rel
+scale(test.oxygen)*cell.area.rel
,data=dhypo.median,na.action = na.omit,method = "ML")
drop1(m4.1,test = "Chisq")
summary(m4.1)
anova(m4.1)
# account only for the interactive effect
m4.2<-gls(surv.time~
scale(test.temp):scale(test.oxygen)
+scale(test.temp)*sex
+scale(test.temp):cell.area.rel
+scale(test.oxygen):cell.area.rel
,data=dhypo.median,na.action = na.omit,method = "ML")
drop1(m4.2,test = "Chisq")
summary(m4.2)
anova(m4.2)
fit.list.step7 <- list(m2.1,m4.1,m4.2)
fit.names.step7 <-c("ST * O2 + ST * sex * O2 + ST * O2 * Cell area",
"ST * O2 + ST * Sex + ST * Cell area + O2 * Cell area",
"ST : O2 + ST * Sex + ST : Cell area + O2 : Cell area")
#compare by using AICc
fit.step7<-aictab(fit.list.step7,fit.names.step7, second.ord = T,sort = TRUE, digits = 3, LL=TRUE)
fit.step7
#                                                       K    AICc Delta_AICc AICcWt Cum.Wt    LL
# ST : O2 + ST * Sex + ST : Cell area + O2 : Cell area  8 -113.42       0.00   0.58   0.58 65.58
# ST * O2 + ST * Sex + ST * Cell area + O2 * Cell area 10 -112.67       0.75   0.40   0.98 67.69
# ST * O2 + ST * sex * O2 + ST * O2 * Cell area        13 -107.07       6.35   0.02   1.00 68.87
#-------------------------------------------------------------------------------
# TABLE S10 SUPPLEMENTARY INFORMATION
#-------------------------------------------------------------------------------
m0<-lm(surv.time~
scale(test.temp)
,data=dhypo.median,na.action = na.omit)
summary(m0)
m0.1<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m0.1)
m1.1<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m1.1)
m1.2<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*cell.area.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m1.2)
m1.3<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*cell.number.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m1.3)
m1.4<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*fw.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m1.4)
m1.5<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*iod.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m1.5)
m2.1<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*cell.area.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m2.1)
m2.2<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*cell.number.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m2.2)
m2.3<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*fw.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m2.3)
m2.4<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*iod.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m2.4)
m3.1<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*cell.area.rel*scale(test.oxygen)
+scale(test.temp)*fw.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m3.1)
m3.2<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*cell.area.rel*scale(test.oxygen)
+scale(test.temp)*cell.number.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m3.2)
m3.3<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex*scale(test.oxygen)
+scale(test.temp)*cell.area.rel*scale(test.oxygen)
+scale(test.temp)*iod.rel*scale(test.oxygen)
,data=dhypo.median,na.action = na.omit)
summary(m3.3)
m4.1<-lm(surv.time~
scale(test.temp)*scale(test.oxygen)
+scale(test.temp)*sex
+scale(test.temp)*cell.area.rel
+scale(test.oxygen)*cell.area.rel
,data=dhypo.median,na.action = na.omit)
fit.list.table.S5 <- list(m0,m0.1,m1.1,m1.2,m1.3,m1.4,m1.5,
m2.1,m2.2,m2.3,m2.4,
m3.1,m3.2,m3.3,
m4.1)
fit.names.table.S5 <-c("TT",
"TT * O2",
"TT * O2 + TT * sex * O2",
"TT * O2 + TT * CA * O2",
"TT * O2 + TT * CN * O2",
"TT * O2 + TT * FM * O2",
"TT * O2 + TT * IOD * O2",
"TT * O2 + TT * sex * O2 + TT * O2 * CA",
"TT * O2 + TT * sex * O2 + TT * O2 * CA",
"TT * O2 + TT * sex * O2 + TT * O2 * CA",
"TT * O2 + TT * sex * O2 + TT * O2 * IOD",
"TT * O2 + TT * sex * O2 + TT * O2 * CA + TT * O2 * FM",
"TT * O2 + TT * sex * O2 + TT * O2 * CA + TT * O2 * CN",
"TT * O2 + TT * sex * O2 + TT * O2 * CA + TT * O2 * IOD",
"TT * O2 + TT * sex + TT * CA + O2 * CA"
)
#compare by using AICc
fit.table.S5<-aictab(fit.list.table.S5,fit.names.table.S5, second.ord = T,sort = TRUE, digits = 3, LL=TRUE)
fit.table.S5
# Model selection based on AICc:
#
#                                                         K    AICc Delta_AICc AICcWt Cum.Wt    LL
# TT * O2 + TT * sex + TT * CA + O2 * CA                 10 -112.67       0.00   0.92   0.92 67.69
# TT * O2 + TT * sex * O2 + TT * O2 * CA                 13 -107.07       5.60   0.06   0.98 68.87
# TT * O2 + TT * sex * O2 + TT * O2 * CA + TT * O2 * IOD 17 -103.33       9.34   0.01   0.99 72.80
# TT * O2 + TT * sex * O2                                 9 -102.26      10.41   0.01   0.99 61.23
# TT * O2 + TT * CA * O2                                  9 -101.85      10.81   0.00   1.00 61.02
# TT * O2                                                 5  -98.32      14.35   0.00   1.00 54.51
# TT * O2 + TT * sex * O2 + TT * O2 * CA + TT * O2 * FM  17  -98.28      14.39   0.00   1.00 70.27
# TT * O2 + TT * sex * O2 + TT * O2 * IOD                13  -97.87      14.79   0.00   1.00 64.27
# TT * O2 + TT * sex * O2 + TT * O2 * CA + TT * O2 * CN  17  -97.32      15.35   0.00   1.00 69.79
# TT * O2 + TT * sex * O2 + TT * O2 * CA                 13  -96.25      16.42   0.00   1.00 63.46
# TT * O2 + TT * sex * O2 + TT * O2 * CA                 13  -95.62      17.05   0.00   1.00 63.14
# TT * O2 + TT * IOD * O2                                 9  -94.08      18.59   0.00   1.00 57.14
# TT * O2 + TT * FM * O2                                  9  -92.58      20.08   0.00   1.00 56.39
# TT * O2 + TT * CN * O2                                  9  -92.47      20.20   0.00   1.00 56.33
# TT                                                      3  -83.93      28.73   0.00   1.00 45.10
#export table
write.csv(fit.table.S5,"../Outputs/6.1.1. Table S5 Model comparison of survival time at two kPa.csv",row.names = FALSE)
# ------------------------------------------------------------------------------
# Script to plot correlations among traits measured in twenty DGRP lines
# ------------------------------------------------------------------------------
# Data generated by F?lix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# Script created by F?lix P Leiva, Radboud University (e-mail: felixpleiva@gmail.com)
# ------------------------------------------------------------------------------
# Cite as:
# Leiva FP, Santos M, Rezende EL & Verberk WCEP. (2021). Paper data and code of
# manuscript: Intraspecific variation on heat tolerance in a model ectotherm:
# the role of oxygen, cell size and body size. Zenodo.
# https://doi.org/10.5281/zenodo.5120028.
# ------------------------------------------------------------------------------
# Cleaning working space
rm(list=ls())
today<-format(Sys.Date(),"%Y%m%d")
# ------------------------------------------------------------------------------
# set the working directory to the folder containing this script:
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()# check directory
# -------------------------------------------------------------------------------------
#Libraries
library(lme4)
library(ggplot2)
library(cowplot)
# -------------------------------------------------------------------------------------
# load data
traits<-read.csv("../Outputs/2.1.1. Phenotypic traits data of DGRP lines.csv")
head(traits)
str(traits)
traits$stock<-as.factor(traits$stock)
traits$sex<-as.factor(traits$sex)
#reorder the columns
traits<-traits[,c(1:6,8,9,7,11,10)]
names(traits)
traits.mean<-aggregate(cbind(fw,iod,ws,cell.number,cell.area)~stock+genotype+sex,traits,mean)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
my_cols <- c('#4DAC2660', '#A6761D60')
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = my_cols[traits$sex])
}
# Create the plots
pairs(traits[,7:11],cex.labels = 1.4,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
my_cols <- c('#4DAC2660', '#A6761D60')
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
my_cols <- c('#4DAC2660', '#A6761D60')
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = my_cols[traits.mean$sex])
}
# Create the plots
pairs(traits.mean[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
my_cols <- c('#4DAC2660', '#A6761D60')
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = my_cols[traits.mean$sex])
}
# Create the plots
pairs(traits.mean[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
#pdf("../Outputs/8.2.1. Figure S3 Pairwise correlation among among traits (mean values for females and males pooled).pdf",width = 7,height = 7)
png("../Outputs/8.2.1. Figure S3 Pairwise correlation among among traits (mean values for females and males pooled).png",width = 7,height = 7,units = "in",res = 1200)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
my_cols <- c('#4DAC2660', '#A6761D60')
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = my_cols[traits.mean$sex])
}
# Create the plots
pairs(traits.mean[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
# -------------------------------------------------------------------------------------
# FIGURE S3
# -------------------------------------------------------------------------------------
{
pdf("../Outputs/8.2.1. Figure S3 Pairwise correlation among among traits (mean values for females and males pooled).pdf",width = 7,height = 7)
#png("../Outputs/8.2.1. Figure S3 Pairwise correlation among among traits (mean values for females and males pooled).png",width = 7,height = 7,units = "in",res = 1200)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
my_cols <- c('#4DAC2660', '#A6761D60')
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = my_cols[traits.mean$sex])
}
# Create the plots
pairs(traits.mean[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
}
female<-subset(traits.mean,sex=="female")
female$stock <- reorder(female$stock, female$cell.area)
levels(female$stock)#to check if order is 0K
col.female1=col=c("#CC3333","#993366","#666699","#339999","#339966","#669966","#666666","#996699","#CC6666","#FF6633",
"#FF9900","#FFCC33","#FFFF33","#CC9933","#996633","#c00000","#CC6699","#FF99CC","#CC9999","#999999")
# -------------------------------------------------------------------------------------
# FIGURE S4
# -------------------------------------------------------------------------------------
{
#pdf("../Outputs/8.2.2. Figure S4 Pairwise correlation among among traits (mean values for females).pdf",width = 7,height = 7)
png("../Outputs/8.2.2. Figure S4 Pairwise correlation among among traits (mean values for females).png",width = 7,height = 7,units = "in",res = 1200)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = col.female1[female$stock])
}
# Create the plots
pairs(female[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
}
# -------------------------------------------------------------------------------------
# FIGURE S4
# -------------------------------------------------------------------------------------
{
pdf("../Outputs/8.2.2. Figure S4 Pairwise correlation among among traits (mean values for females).pdf",width = 7,height = 7)
#png("../Outputs/8.2.2. Figure S4 Pairwise correlation among among traits (mean values for females).png",width = 7,height = 7,units = "in",res = 1200)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = col.female1[female$stock])
}
# Create the plots
pairs(female[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
}
# -------------------------------------------------------------------------------------
# FIGURE S5
# -------------------------------------------------------------------------------------
male<-subset(traits.mean,sex!="female")
male$stock <- reorder(male$stock, male$cell.area)
levels(male$stock)#to check if order is 0K
col.male1=col=c("#CC3333","#666699","#666666","#339999","#993366","#339966","#996633","#FF9900","#669966","#FFFF33",
"#996699","#CC9933","#CC6666","#FF6633","#FFCC33","#c00000","#FF99CC","#CC9999","#CC6699","#999999")
{
pdf("../Outputs/8.2.4. Figure S6 Pairwise correlation among among traits (mean values for males).pdf",width = 7,height = 7)
#png("../Outputs/8.2.4. Figure S6 Pairwise correlation among among traits (mean values for males).png",width = 7,height = 7,units = "in",res = 300)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = col.male1[male$stock])
}
# Create the plots
pairs(male[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
}
# -------------------------------------------------------------------------------------
# FIGURE S5
# -------------------------------------------------------------------------------------
male<-subset(traits.mean,sex!="female")
male$stock <- reorder(male$stock, male$cell.area)
levels(male$stock)#to check if order is 0K
col.male1=col=c("#CC3333","#666699","#666666","#339999","#993366","#339966","#996633","#FF9900","#669966","#FFFF33",
"#996699","#CC9933","#CC6666","#FF6633","#FFCC33","#c00000","#FF99CC","#CC9999","#CC6699","#999999")
{
pdf("../Outputs/8.2.3. Figure S5 Pairwise correlation among among traits (mean values for males).pdf",width = 7,height = 7)
#png("../Outputs/8.2.3. Figure S5 Pairwise correlation among among traits (mean values for males).png",width = 7,height = 7,units = "in",res = 300)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = col.male1[male$stock])
}
# Create the plots
pairs(male[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
}
{
#pdf("../Outputs/8.2.3. Figure S5 Pairwise correlation among among traits (mean values for males).pdf",width = 7,height = 7)
png("../Outputs/8.2.3. Figure S5 Pairwise correlation among among traits (mean values for males).png",width = 7,height = 7,units = "in",res = 300)
par(mfrow=c(1,1),tcl=-0.4, family="serif",
omi=c(0,0,0,0))
panel.cor <- function(x, y){
usr <- par("usr"); on.exit(par(usr))
par(usr = c(0, 1, 0, 1))
r <- round(cor(x, y), digits=2)
txt <- paste0("R = ", r)
cex.cor <- 0.8/strwidth(txt)
text(0.5, 0.5, txt, cex = cex.cor * r)
}
# Customize upper panel
upper.panel<-function(x, y){
points(x,y,cex=1.2, pch=16,col = col.male1[male$stock])
}
# Create the plots
pairs(male[,4:8],cex.labels = 1.4,gap = 0,
labels = c("Fresh mass","IOD","Wing area","Cell number","Cell area"),
lower.panel = panel.cor,
upper.panel = upper.panel)
dev.off()
}
